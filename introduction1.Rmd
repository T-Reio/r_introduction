---
title: "An Introduction to R"
author:
  - "Reio Tanji"
  - "Osaka Univ., Graduate School of Econ."
date: "April, 2022"
output: 
  revealjs::revealjs_presentation:
    self_contained: FALSE
    theme: serif
    css: introduction.css
    reveal_plugins: ["menu"]
    reveal_options:
      menu:
        numbers: TRUE
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# R言語を使う

**R言語とは？**

- "*R is a free software environment for statistical computing and graphics*"<br>(from [The R Project for Statistical Computing](https://www.r-project.org/))

    - 統計計算、グラフ作成を行うことができる無料のツール
    - データの収集、管理、分析から結果の出力・プレゼンテーションの作成までを一つの言語で行うことも出来る
    - この資料もRを使って作成(R Markdown)

- 目標

    - 今回は、Rの基本的な操作方法を学習した上で、論文執筆の上で最低限必要なアウトプットのための技術習得をめざす

## Rでできること

-   データの操作：tidyverse

    - データの取得：デフォルトのデータセット、csvファイル等の読み込み
    - データの整理：必要な情報の抽出、データの変形、新たな変数の作成と保存

- データの可視化

    - 変数間の関係を視覚的に描写：graphics, ggplot2

- データ分析

    - 基本統計量の作成
    - 計量経済学・統計学で用いられる様々な手法の実装
    - 結果の出力

- レポートの作成

    - 分析結果をスライドにして報告 RMarkdown

        - Word, Powerpoint形式でファイルを出力

    - 出力の保存や体裁を整える手間が削減できる

## 基本構造

- 基本的には、というか全ての命令は

    - Rに命令を投げる→命令に従って計算(描画・読み込みなど)を行う

    - 必要であればアウトプットを返す

    の繰り返し

- エレベーターの3階ボタンを押す→3階に向かう、ドアを開ける

    - ボタンを押すエネルギーでエレベータが動いているわけではない
    - ワイヤーをどれだけ巻き取ればどれだけ上昇・下降するのか、ドアを開けるためにどの部分にどれだけ力を加えればいいのか、が3回ボタンを押したときに発せられる命令として書かれている

- この命令を一つ一つ書く作業を行う

# Setup

- **R言語**と**R Studio**の2つをインストール
  - R言語をスムーズに利用するためのツール：開発環境がRStudio
  - デフォルトでR GUI と呼ばれる開発環境がインストールされるが、色々な理由から使いづらい
    - 罫線の引いてあるノートに書くか、自由帳に書くかみたいな違い
    - 最終的にR言語で命令を書くのは同じ
  - その他にも Jupyter Notebook, VS Code, Atomなど様々な開発環境があるので、好きなものを使えばよい
- R Studio Cloud: クラウド上でR Studioの機能を利用できるサービス
  - 無料の場合は月あたりの利用時間が制限されるなど問題はあるが、特に自前PCのない人は検討してみてもよいかも

## インストール

Click: [Download R](https://cran.ism.ac.jp/)
[RStudio Desktop](https://www.rstudio.com/products/rstudio/download/#download)

- 【定期】詰まったら4回生に訊いて下さい
- それぞれ必ず最新バージョンをダウンロードすること
  - 定期的にアップデートしておくのがおすすめ、たまに関数の仕様とかが大幅に変わる
  - たぶんいないと思いますが、Ver.4.0.0以前のものを使用している4回生はインストールし直して下さい

## R Studioの基本画面

- 4つの画面 (Pane)が表示される: コードを入力するのは Source, Consoleの2つ
  - Source：Rスクリプトなどを編集・保存
  - Console：実行するコードを直接入力・実行できる。
  - 右側の Pane では読み込んだデータフレームやオブジェクトの定義確認、図表出力のチェックなどが行える
  
```{r, out.width="77%", echo=FALSE, fig.align='center'}
knitr::include_graphics("figs/rstudio_appearance.png")
```

# プロジェクトの作成、バージョン管理

# 基本操作
- "r_introduction"というプロジェクトを作成、事前に配布したファイルの中身をその中に展開

- R Studioを開く
  - R Consoleにコードを直接入力してEnter、もしくはRスクリプトにコードを記述してCtrl + Enterで実行
  - RスクリプトはCtrl+Shift+Nで作成可能

```{r K3}
1 + 2 * (3 / 4) # 掛け算は*で
13 %% 5 # 剰余
```

  - その他、基本的な演算記号は[R-Tips](http://cse.naro.affrc.go.jp/takezawa/r-tips/r.html)などを参照せよ

## 関数

## 変数の型

- 数値だけでなく、文字も扱うことができる
  - 何を使っても良いわけではない：Excelも一緒
    - 電話番号を入力したのに頭の0が消える→Excelが電話番号を数値として認識してしまっているから
  - 文字列を""で囲って表記するすることで、それが文字列であることをRに伝えることができる
```{r class}
class(3.14) # class()はその変数の型を返す関数
class('1.90') # 文字列 character と判定される
```
  - numeric, integerは足し引きできるが、characterはできない
  - 順序付きの文字列: factor
```{r character, eval=FALSE}
"1" + "2"
```

## オブジェクト

- では""で囲わずに入力した文字列はどう認識されるのか？
  1. 特定の値と結びついている
  
## ベクトル

- ベクトル：複数の要素を含む列
  - `c(a, b, c, ...)`

## データフレーム

## リスト

# データの操作

# データの可視化

# 分析と結果の表示

# RMarkdownを用いたレポートの作成

# おまけ：バージョン管理

- 論文執筆・輪読の資料報告は班単位で行うので、スライドや分析結果を複数人で作成・共有する必要がある
- Dropbox, Github, Google Drive などでファイルごと共有しておくと、スライドをくっつけたり各自が修正したものをすり合わせる作業が削減できる、たぶん
- 覚えておいて損はないのでまあ興味があれば訊いて下さい